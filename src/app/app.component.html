<header class="header-nav">
  <div class="container nav-container">
    <a routerLink="/" class="nav-brand">B3D Pl√°sticos</a>
    <nav>
      <a routerLink="/tienda" routerLinkActive="active">Tienda</a>
      @if (authService.isLoggedIn()) {
        <a routerLink="/historial" routerLinkActive="active">Mis Pedidos</a>
      }

      <a routerLink="/carrito" routerLinkActive="active" class="nav-carrito">
        <span class="carrito-icon">üõí</span>
      </a>

      <div class="profile-section">
        @if (authService.isLoggedIn()) {
          <button class="profile-trigger" (click)="toggleMenu()">
            @if (authService.currentUserFotoUrl()) {
              <img [src]="authService.currentUserFotoUrl()" alt="Foto de perfil" class="profile-trigger-img">
            } @else {
              <span>{{ getUserInitials() }}</span>
            }
          </button>

          <div class="profile-menu" [class.show]="menuVisible()">
             <div class="profile-menu-header">
                @if (authService.currentUserFotoUrl()) {
                  <img [src]="authService.currentUserFotoUrl()" alt="Foto de perfil" class="profile-menu-img">
                } @else {
                  <span class="profile-menu-avatar">{{ getUserInitials() }}</span>
                }
                <strong>{{ authService.currentUserName() || 'Usuario' }}</strong>
                <small>{{ authService.currentUserEmail() || 'email@ejemplo.com' }}</small>
             </div>
             <ul>
               <li><a routerLink="/perfil" (click)="menuVisible.set(false)">üë§ Mi perfil</a></li>
               <li><a routerLink="/historial" (click)="menuVisible.set(false)">üõçÔ∏è Mis pedidos</a></li>
               <li><a routerLink="/favoritos" (click)="menuVisible.set(false)">‚ù§Ô∏è Favoritos</a></li>
               <li><hr></li>
               <li><a (click)="logout()" style="cursor: pointer;">‚Ü™Ô∏è Cerrar sesi√≥n</a></li>
             </ul>
          </div>
        } @else {
          <a routerLink="/auth" routerLinkActive="active" class="nav-cta">Login</a>
        }
      </div>

    </nav>
  </div>
</header>

<main>
  <div class="container main-content">
    <router-outlet></router-outlet>
  </div>
</main>

<footer class="footer">
  <div class="container">
    <p>&copy; 2025 B3D Casa Bureu Pl√°sticos. Todos los derechos reservados.</p>
  </div>
</footer>